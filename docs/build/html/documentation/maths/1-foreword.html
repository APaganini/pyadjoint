
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Foreword</title>
    
    <link rel="stylesheet" href="../../_static/fenics.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2017.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<link rel="stylesheet" href="../../_static/featured.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="../../_static/slides.min.jquery.js"></script>
  <script>
	$(function(){
		$('#products').slides({
			preload: true,
			preloadImage: 'img/loading.gif',
			effect: 'slide, fade',
			crossfade: true,
			slideSpeed: 350,
			fadeSpeed: 500,
			generateNextPrev: false,
			generatePagination: false,
	                play: 5000,
                        hoverPause: false,
                        animationStart: function(current){
				$('.caption').animate({
					bottom:-35
				},100);
				if (window.console && console.log) {
					// example return of current slide number
					console.log('animationStart on slide: ', current);
				};
			},
			animationComplete: function(current){
				$('.caption').animate({
					bottom:0
				},200);
				if (window.console && console.log) {
					// example return of current slide number
					console.log('animationComplete on slide: ', current);
				};
			},
			slidesLoaded: function() {
				$('.caption').animate({
					bottom:0
				},200);
			}
		});
	});
  </script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31806773-1']);
  _gaq.push(['_setDomainName', 'dolfin-adjoint.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Load the flex slider library -->
<link rel="stylesheet" href="_static/flexslider/flexslider.css" type="text/css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script src="_static/flexslider/jquery.flexslider.js"></script>

<script type="text/javascript" charset="utf-8">
  $(window).load(function() {
  $('.flexslider').flexslider();
  });
</script>

<!-- Load the code highlight library -->
<link rel="stylesheet" href="_static/highlight/styles/zenburn.css">
<script src="_static/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<link rel="shortcut icon" href="../../_static/icon.ico" />


  </head>
  <body>
<div class="wrapper">
  <a href="../../"><img src="../../_static/banner.png" width="900px" alt="dolfin-adjoint Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
          <li class="page_item"><a href="../../about/index.html" title="Find out more about dolfin-adjoint">About</a></li>
          <li class="page_item"><a href="../../features/index.html" title="Features of dolfin-adjoint">Features</a></li>
          <li class="page_item"><a href="../index.html" title="Learn how to use dolfin-adjoint">Documentation</a></li>
          <li class="page_item"><a href="../../download/index.html" title="Obtain the dolfin-adjoint code">Download</a></li>
          <li class="page_item"><a href="../../citing/index.html" title="Learn how to cite the dolfin-adjoint project">Citing</a></li>
          <li class="page_item"><a href="../../support/index.html" title="Where to go for more help">Support</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="foreword">
<h1>Foreword<a class="headerlink" href="#foreword" title="Permalink to this headline">¶</a></h1>
<p><em>Written by Patrick E. Farrell</em></p>
<div class="section" id="why-care-about-adjoints">
<h2>Why care about adjoints?<a class="headerlink" href="#why-care-about-adjoints" title="Permalink to this headline">¶</a></h2>
<p>Far too often, maths books launch into their subject without
explaining to the novice reader why he or she should care about it in
the first place. So, before diving into the details, let’s take a few
minutes to motivate why adjoint techniques were invented.</p>
<p>Suppose an aeronautical engineer wishes to design a wing. The wing is
parametrised by a vector <span class="math">\(m\)</span>; for example, suppose each entry of
<span class="math">\(m\)</span> is the coefficient of a Bézier curve. For any potential wing
design <span class="math">\(m\)</span>, the Euler equations can be solved, and the
lift-to-drag ratio <span class="math">\(J\)</span> of the design computed.  With an adjoint,
the engineer can do far more: the adjoint computes <em>the derivative of
the drag with respect to the design parameters</em>. This can be used to
guide a human designer, or can be passed to an automated optimisation
algorithm to automatically compute an optimal
shape. <a class="reference internal" href="#jameson1988" id="id1">[1M-Jam88]</a> <a class="reference internal" href="#giles2000" id="id2">[1M-GP00]</a>.  In the literature, this
concept is referred to as adjoint design optimisation.</p>
<p>Suppose a meteorologist wishes to improve a forecast by constraining
the weather model to match atmospheric observations. The state of the
atmosphere at the initial time is partially known (from weather
stations), but in order to initialise the model an initial condition
for the whole world is required. For any guess of the (unknown)
initial state of the atmosphere <span class="math">\(m\)</span>, the Navier-Stokes and
related equations can be solved, and the weighted misfit <span class="math">\(J\)</span>
between the observed values and the simulation results can be
computed. With an adjoint, the meteorologist can <em>systematically
update their guess for the initial state of the atmosphere</em> to match
the observations <a class="reference internal" href="#ledimet1986" id="id3">[1M-LDT86]</a> <a class="reference internal" href="#talagrand1987" id="id4">[1M-TC87]</a>. In the
literature, this concept is referred to as variational data
assimilation, 3D-Var and 4D-Var.</p>
<p>Suppose an oceanographer wishes to understand the impact of bottom
topography on transport through the Drake passage. Bottom topography
(the shape of the sea floor) is quite poorly known; many areas of the
world are sparsely observed, and observations from over a century ago
are still used in some places. The bottom topography is represented as
a scalar field <span class="math">\(m\)</span>, the Navier-Stokes and related equations are
solved, and the average net transport through the Drake passage
<span class="math">\(J\)</span> computed. With an adjoint, the oceanographer can see <em>where
the transport is most sensitive to the topography</em>, and so quantify
where the uncertainty matters most <a class="reference internal" href="#losch2007" id="id5">[1M-LH07]</a>. In the
literature, this concept is referred to as sensitivity analysis.</p>
<p>Suppose a nuclear engineer working for a government regulator wishes
to examine a proposed new nuclear reactor design. To do this, a
forward model of the Boltzmann transport equations will be used to
simulate the proposed design and verify its safety. However, all
simulations inherently come with discretisation errors, and unless
those errors are quantified, the simulations cannot be relied upon to
make decisions upon which millions of lives and billions of pounds
depend. With an adjoint, the engineer can <em>quantify the impact of
discretisation errors</em> on the criticality rate, and decide to what
extent the simulations may be trusted <a class="reference internal" href="#becker2001" id="id6">[1M-BR01]</a>. In the
literature, this concept is referred to as goal-based error
estimation, or goal-based adaptivity.</p>
<p>Suppose a mathematician wishes to understand the stability of some
physical system. The traditional approach to this problem is to
linearise the operator and investigate its eigenvalues, which
determine the long-term behaviour of the system (as <span class="math">\(t
\rightarrow \infty\)</span>). However, systems that are eigenvalue-stable can
exhibit unexpected transient growth of small perturbations, which in
turn can cause the system to become unstable (through nonlinear
effects) <a class="reference internal" href="#trefethen1993" id="id7">[1M-TTRD93]</a>. By computing the singular value
decomposition of the tangent linear model, <em>the transient growth of
the system to such perturbations can be quantified, and the optimally
growing perturbations identified</em> <a class="reference internal" href="#farrell1996" id="id8">[1M-FI96]</a>.  The
computation of the singular value decomposition in turn requires the
adjoint. In the literature, this approach is referred to as
generalised stability theory.</p>
<p>As you can see, adjoints show up in many applications, and in many
computational techniques.  One of the reasons why adjoints have a
reputation for being difficult is because their discussion is
performed in many different areas of science, usually with their own
specialised terminology.  Reading the literature, there are almost as
many ways to approach the topic as there are practitioners!  With this
introduction, I hope to strike to the heart of the matter, and clear
some of the confusion with the minimum of application– or
technique–specific lingo.</p>
</div>
<div class="section" id="a-note-on-the-exposition">
<h2>A note on the exposition<a class="headerlink" href="#a-note-on-the-exposition" title="Permalink to this headline">¶</a></h2>
<p>I have chosen to motivate adjoints via a discussion of
<em>PDE-constrained optimisation</em> for two reasons. The first is that this
approach encapsulates many important applications of adjoints in a
general way, and so the reader will be well-equipped to understand
much adjoint-related mathematics in the literature.  The second is the
elegance of the result: most people are amazed when they first learn
that it is possible to compute the gradient of a functional
<span class="math">\(\widehat{J}(m)\)</span> in a cost <em>independent of the number of
parameters</em> <span class="math">\(\textrm{dim}(m)\)</span>! The topic of adjoints is
intriguing, counterintuitive and beautiful; any exposition should try
to live up to that.</p>
<p>The focus of the exposition will be on getting the core ideas across,
and for this reason the discussion will sometimes neglect
technicalities. For example, I will implicitly assume that all
problems are well-posed, that all necessary derivatives exist and are
sufficiently smooth, etc. Occasionally, to build intuition, I will
refer to objects as matrices and vectors, although the exposition
holds in exactly the same way for their analogues in functional
analysis.  For an advanced in-depth technical treatment of
PDE-constrained optimisation, see the excellent book of Hinze et
al. <a class="reference internal" href="../poisson-mother/poisson-mother.html#hinze2009" id="id9">[1E-HPUU09]</a>.</p>
</div>
<div class="section" id="notation">
<h2>Notation<a class="headerlink" href="#notation" title="Permalink to this headline">¶</a></h2>
<p>The notation is mostly inspired by Gunzburger <a class="reference internal" href="#gunzburger2003" id="id10">[1M-Gun03]</a>.</p>
<table border="1" class="colwidths-given center docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Symbol</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(m\)</span></td>
<td>the vector of parameters</td>
</tr>
<tr class="row-odd"><td><span class="math">\(u\)</span></td>
<td>the solution of the PDE</td>
</tr>
<tr class="row-even"><td><span class="math">\(F(u, m)\)</span></td>
<td>the PDE relating <span class="math">\(u\)</span> and <span class="math">\(m\)</span>: <span class="math">\(F \equiv 0\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(J(u, m)\)</span></td>
<td>a functional of interest</td>
</tr>
<tr class="row-even"><td><span class="math">\(\widehat{J}(m)\)</span></td>
<td>the functional considered as a pure function of <span class="math">\(m\)</span>: <span class="math">\(\widehat{J}(m) = J(u(m), m)\)</span></td>
</tr>
</tbody>
</table>
<p>In <a class="reference internal" href="2-problem.html"><span class="doc">the next section</span></a>, we introduce the
PDE-constrained optimisation problem and give a broad overview of how
it may be tackled.</p>
<p class="rubric">References</p>
<p id="bibtex-bibliography-documentation/maths/1-foreword-0"><table class="docutils citation" frame="void" id="becker2001" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[1M-BR01]</a></td><td>R.&nbsp;Becker and R.&nbsp;Rannacher. An optimal control approach to a posteriori error estimation in finite element methods. <em>Acta Numerica</em>, 10:1–102, 2001. <a class="reference external" href="https://doi.org/10.1017/S0962492901000010">doi:10.1017/S0962492901000010</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="farrell1996" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[1M-FI96]</a></td><td>B.&nbsp;F. Farrell and P.&nbsp;J. Ioannou. Generalized stability theory. Part I: Autonomous operators. <em>Journal of the Atmospheric Sciences</em>, 53(14):2025–2040, 1996. <a class="reference external" href="https://doi.org/10.1175/1520-0469(1996)053&lt;2025:GSTPIA&gt;2.0.CO;2">doi:10.1175/1520-0469(1996)053&lt;2025:GSTPIA&gt;2.0.CO;2</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="giles2000" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1M-GP00]</a></td><td>M.&nbsp;B. Giles and N.&nbsp;A. Pierce. An introduction to the adjoint approach to design. <em>Flow, Turbulence and Combustion</em>, 65(3-4):393–415, 2000. <a class="reference external" href="https://doi.org/10.1023/A:1011430410075">doi:10.1023/A:1011430410075</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gunzburger2003" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[1M-Gun03]</a></td><td>M.&nbsp;D. Gunzburger. <em>Perspectives in Flow Control and Optimization</em>. Advances in Design and Control. SIAM, 2003. ISBN 089871527X.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hinze2009" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[1E-HPUU09]</a></td><td>M.&nbsp;Hinze, R.&nbsp;Pinnau, M.&nbsp;Ulbrich, and S.&nbsp;Ulbrich. <em>Optimization with PDE constraints</em>. Volume&nbsp;23 of Mathematical Modelling: Theory and Applications. Springer, 2009. ISBN 978-1-4020-8838-4.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="jameson1988" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1M-Jam88]</a></td><td>A.&nbsp;Jameson. Aerodynamic design via control theory. <em>Journal of Scientific Computing</em>, 3(3):233–260, 1988. <a class="reference external" href="https://doi.org/10.1007/BF01061285">doi:10.1007/BF01061285</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="ledimet1986" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1M-LDT86]</a></td><td>F.-X. Le&nbsp;Dimet and O.&nbsp;Talagrand. Variational algorithms for analysis and assimilation of meteorological observations: theoretical aspects. <em>Tellus A</em>, 38A(2):97–110, 1986. <a class="reference external" href="https://doi.org/10.1111/j.1600-0870.1986.tb00459.x">doi:10.1111/j.1600-0870.1986.tb00459.x</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="losch2007" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[1M-LH07]</a></td><td>M.&nbsp;Losch and P.&nbsp;Heimbach. Adjoint sensitivity of an ocean general circulation model to bottom topography. <em>Journal of Physical Oceanography</em>, 37(2):377–393, 2007. <a class="reference external" href="https://doi.org/10.1175/JPO3017.1">doi:10.1175/JPO3017.1</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="talagrand1987" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[1M-TC87]</a></td><td>O.&nbsp;Talagrand and P.&nbsp;Courtier. Variational assimilation of meteorological observations with the adjoint vorticity equation. I: Theory. <em>Quarterly Journal of the Royal Meteorological Society</em>, 113(478):1311–1328, 1987. <a class="reference external" href="https://doi.org/10.1002/qj.49711347812">doi:10.1002/qj.49711347812</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="trefethen1993" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[1M-TTRD93]</a></td><td>L.&nbsp;N. Trefethen, A.&nbsp;E. Trefethen, S.&nbsp;C. Reddy, and T.&nbsp;A. Driscoll. Hydrodynamic stability without eigenvalues. <em>Science</em>, 261(5121):578–584, 1993. <a class="reference external" href="https://doi.org/10.1126/science.261.5121.578">doi:10.1126/science.261.5121.578</a>.</td></tr>
</tbody>
</table>
</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Sebastian Mitusch.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.2.
    </div>
  </body>
</html>