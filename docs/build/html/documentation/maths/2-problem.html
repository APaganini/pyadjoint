
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PDE-constrained optimisation</title>
    
    <link rel="stylesheet" href="../../_static/fenics.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2017.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<link rel="stylesheet" href="../../_static/featured.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="../../_static/slides.min.jquery.js"></script>
  <script>
	$(function(){
		$('#products').slides({
			preload: true,
			preloadImage: 'img/loading.gif',
			effect: 'slide, fade',
			crossfade: true,
			slideSpeed: 350,
			fadeSpeed: 500,
			generateNextPrev: false,
			generatePagination: false,
	                play: 5000,
                        hoverPause: false,
                        animationStart: function(current){
				$('.caption').animate({
					bottom:-35
				},100);
				if (window.console && console.log) {
					// example return of current slide number
					console.log('animationStart on slide: ', current);
				};
			},
			animationComplete: function(current){
				$('.caption').animate({
					bottom:0
				},200);
				if (window.console && console.log) {
					// example return of current slide number
					console.log('animationComplete on slide: ', current);
				};
			},
			slidesLoaded: function() {
				$('.caption').animate({
					bottom:0
				},200);
			}
		});
	});
  </script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31806773-1']);
  _gaq.push(['_setDomainName', 'dolfin-adjoint.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Load the flex slider library -->
<link rel="stylesheet" href="_static/flexslider/flexslider.css" type="text/css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script src="_static/flexslider/jquery.flexslider.js"></script>

<script type="text/javascript" charset="utf-8">
  $(window).load(function() {
  $('.flexslider').flexslider();
  });
</script>

<!-- Load the code highlight library -->
<link rel="stylesheet" href="_static/highlight/styles/zenburn.css">
<script src="_static/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<link rel="shortcut icon" href="../../_static/icon.ico" />


  </head>
  <body>
<div class="wrapper">
  <a href="../../"><img src="../../_static/banner.png" width="900px" alt="dolfin-adjoint Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
          <li class="page_item"><a href="../../about/index.html" title="Find out more about dolfin-adjoint">About</a></li>
          <li class="page_item"><a href="../../features/index.html" title="Features of dolfin-adjoint">Features</a></li>
          <li class="page_item"><a href="../index.html" title="Learn how to use dolfin-adjoint">Documentation</a></li>
          <li class="page_item"><a href="../../download/index.html" title="Obtain the dolfin-adjoint code">Download</a></li>
          <li class="page_item"><a href="../../citing/index.html" title="Learn how to cite the dolfin-adjoint project">Citing</a></li>
          <li class="page_item"><a href="../../support/index.html" title="Where to go for more help">Support</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pde-constrained-optimisation">
<h1>PDE-constrained optimisation<a class="headerlink" href="#pde-constrained-optimisation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="problem-statement">
<h2>Problem statement<a class="headerlink" href="#problem-statement" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math">\(m\)</span> be a vector of some parameters. For example, <span class="math">\(m\)</span>
might be the values of an initial condition, or of a source term, or
of a boundary condition.</p>
<div class="sidebar">
<p class="first sidebar-title">Feasibility</p>
<p class="last">In optimisation, to say that a point <span class="math">\(m\)</span> in parameter space is
<em>feasible</em> means that it satisfies all of the constraints on the
choice of parameters. To say that the pair <span class="math">\((u, m)\)</span> is
feasible means that <span class="math">\(m\)</span> is feasible, <em>and</em> that <span class="math">\(u\)</span>
satisfies the relationship <span class="math">\(F(u, m) = 0\)</span>.</p>
</div>
<p>Let <span class="math">\(F(u, m) \equiv 0\)</span> be a (system of) partial differential
equations that describe the physics of the problem of
interest. <span class="math">\(F\)</span> is a vector expression (one entry for each
equation), with all terms in the equation gathered on to the left-hand
side. The idea is that, for any (feasible) choice of <span class="math">\(m \in \mathbb{R}^M\)</span>, the
PDE <span class="math">\(F\)</span> can be solved to yield the solution <span class="math">\(u \in \mathbb{R}^U\)</span>. In other
words, <em>the solution</em> <span class="math">\(u\)</span> <em>can be thought of as an implicit
function</em> <span class="math">\(u(m)\)</span> <em>of the parameters</em> <span class="math">\(m\)</span>, related through
the PDE <span class="math">\(F(u, m) \equiv 0\)</span>. We never have an explicit expression
for <span class="math">\(u\)</span> in terms of <span class="math">\(m\)</span>, but as we shall see, we can still
discuss its derivative <span class="math">\({\mathrm{d}u}/{\mathrm{d}m}\)</span>.</p>
<p>If the problem <span class="math">\(F(u, m)\)</span> is time-dependent, this abstraction
still holds. In this case, think of <span class="math">\(u\)</span> as a vector containing
all time values of all prognostic variables. In the discrete case,
<span class="math">\(u\)</span> is a vector with the value of the solution at the first
timestep, then the value at the second timestep, and so on, for
however many timesteps are required.</p>
<p>Finally, let <span class="math">\(J(u, m)\)</span> be a <em>functional</em> of interest. <span class="math">\(J\)</span>
represents the quantity to be optimised: for example, the quality of a
design is to be maximised, or the misfit between observations and
computations is to be minimised.</p>
<p>A general statement of the PDE-constrained optimisation problem is
then given as follows: find the <span class="math">\(m\)</span> that minimises <span class="math">\(J(u,
m)\)</span>, subject to the constraint that <span class="math">\(F(u, m) = 0\)</span>. For
simplicity, we suppose that there are no further constraints on the
choice of <span class="math">\(m\)</span>; there are well-known techniques for handling such
situations. If <span class="math">\(J\)</span> is to be maximised instead of minimised, just
consider minimising the functional <span class="math">\(-J\)</span>.</p>
<p>Throughout this introduction, we shall implicitly consider the case
where <em>the dimension of the parameter space is very large</em>. This means
that we shall seek out algorithms that scale well with the dimension
of the parameter space, and discard those that do not. We shall also
generally assume that <em>solving the PDE is very expensive</em>: therefore,
we will seek out algorithms which attempt to minimise the number of
PDE solutions required. This combination of events – a large
parameter space, and an expensive PDE – is the most interesting,
common, practical and difficult situation, and therefore it is the one
we shall attempt to tackle head-on.</p>
<div class="sidebar">
<p class="first sidebar-title">Functional</p>
<p class="last">A <em>functional</em> is a function that acts on some vector space, and
<em>returns a single scalar number</em>.</p>
</div>
</div>
<div class="section" id="solution-approaches">
<h2>Solution approaches<a class="headerlink" href="#solution-approaches" title="Permalink to this headline">¶</a></h2>
<p>There are many ways to approach solving this problem. The approach
that we shall take here is to apply a <em>gradient-based optimisation
algorithm</em>, as these techniques scale to large numbers of parameters
and to complex, nonlinear, time-dependent PDE constraints.</p>
<p>To apply an optimisation algorithm, we will convert the
PDE-constrained optimisation problem into an unconstrained
optimisation problem. Let <span class="math">\(\widehat{J}(m) \equiv J(u(m), m)\)</span> be
the functional <em>considered as a pure function of the parameters</em>
<span class="math">\(m\)</span>: that is, to compute <span class="math">\(\widehat{J}(m)\)</span>, solve the PDE
<span class="math">\(F(u, m) = 0\)</span> for <span class="math">\(u\)</span>, and then evaluate <span class="math">\(J(u,
m)\)</span>. The functional <span class="math">\(\widehat{J}\)</span> has the PDE constraint “built
in”: by considering <span class="math">\(\widehat{J}\)</span> instead of <span class="math">\(J\)</span>, we
convert the constrained optimisation problem to a simpler,
unconstrained one. The problem is now posed as: find the <span class="math">\(m\)</span>
that minimises <span class="math">\(\widehat{J}(m)\)</span>.</p>
<p>Given some software that solves the PDE <span class="math">\(F(u, m) = 0\)</span>, we have a
black box for computing the value of the functional
<span class="math">\(\widehat{J}\)</span>, given some argument <span class="math">\(m\)</span>. If we can only
evaluate the functional, and have no information about its
derivatives, then we are forced to use a gradient-free optimisation
algorithm such as a genetic algorithm. The drawback of such methods is
that they typically scale very poorly with the dimension of the
parameter space: even for a moderate sized parameter space, a
gradient-free algorithm will typically take hundreds or thousands of
functional evaluations before terminating. Since each functional
evaluation involves a costly PDE solve, such an approach quickly
becomes impractical.</p>
<div class="sidebar">
<p class="first sidebar-title">Other approaches</p>
<p class="last">No discussion of PDE-constrained optimisation would be complete
without mentioning the “oneshot” approach. Instead of starting with
some initial guess <span class="math">\(m\)</span> and applying an optimisation algorithm,
the oneshot approach derives auxiliary equations that provide
necessary and sufficient conditions for finding an optimum. These
coupled equations are then solved, almost always with a matrix-free
approach. The necessary and sufficient conditions are referred to as
the KKT conditions, and the system referred to as the KKT system,
after Karush, Kuhn and Tucker, the mathematicians who derived the
optimality system <a class="reference internal" href="#karush1939" id="id1">[2M-Kar39]</a> <a class="reference internal" href="#kuhn1951" id="id2">[2M-KT51]</a>.
Interestingly, one of the equations in the KKT system is the adjoint
equation, which will be derived in a different way in the next
section.</p>
</div>
<p>By contrast, optimisation algorithms that can exploit information
about the derivatives of <span class="math">\(\widehat{J}\)</span> can typically converge
onto a local minimum with one or two orders of magnitude fewer
iterations, as the gradient provides information about where to step
next in parameter space. Therefore, if evaluating the PDE solution is
expensive (and it usually is), then computing derivative information
of <span class="math">\(\widehat{J}\)</span> becomes very important for the practical
solution of such PDE-constrained optimisation problems.</p>
<p>So, how should the gradient
<span class="math">\({\mathrm{d}\widehat{J}}/{\mathrm{d}m}\)</span> be computed? There are
three main approaches, each with their own advantages and
disadvantages. Discussing these strategies is the topic of <a class="reference internal" href="3-gradients.html"><span class="doc">the
next section</span></a>.</p>
<p class="rubric">References</p>
<p id="bibtex-bibliography-documentation/maths/2-problem-0"><table class="docutils citation" frame="void" id="karush1939" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[2M-Kar39]</a></td><td>W.&nbsp;Karush. Minima of functions of several variables with inequalities as side constraints. Master’s thesis, University of Chicago, Chicago, IL, USA, 1939.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="kuhn1951" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2M-KT51]</a></td><td>H.&nbsp;W. Kuhn and A.&nbsp;W. Tucker. Nonlinear programming. In <em>Proceedings of 2nd Berkeley Symposium</em>, 481–492. University of California Press, 1951.</td></tr>
</tbody>
</table>
</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Sebastian Mitusch.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.2.
    </div>
  </body>
</html>